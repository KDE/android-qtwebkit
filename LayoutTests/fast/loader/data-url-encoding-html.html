<meta charset="koi8-r">
<body onload="test()">
<p>Test that non-ASCII data: URLs are handled correctly.</p>
<pre id=result></pre>
<script>
if (window.layoutTestController)
    layoutTestController.dumpAsText();

function test() {
    document.getElementById("result").innerHTML += "1. " + (window.frames[0].document.characterSet == "windows-1255" ? "SUCCESS" : "FAILURE: " + window.frames[0].document.characterSet) + ".\r";
    document.getElementById("result").innerHTML += "2. Should be your browser's default encoding: " + window.frames[1].document.characterSet
        + ". The result is currently wrong due to &lt;rdar://problem/5845875> REGRESSION: -[NSURLResponse textEncoding] incorrectly reports us-ascii encoding for data: URLs.";
}
</script>
<iframe src="data:text/html;charset=windows-1255,<body></body>"></iframe>
<iframe src="data:text/html,<body></body>"></iframe>
</body>
