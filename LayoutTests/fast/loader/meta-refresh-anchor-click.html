<html>
    <head>
        <script>
            var count = 0;
            function init()
            {
                if (layoutTestController) {
                    layoutTestController.dumpAsText();
                    layoutTestController.waitUntilDone();
                }
            }
            function bumpCount()
            {
                ++count;
                document.getElementById("count").innerHTML = count;
                if (count == 10) {
                    var subframeDocument = frames[0].document;
                    var event = subframeDocument.createEvent("MouseEvents");
                    event.initEvent("click", true, true);
                    subframeDocument.getElementById("link").dispatchEvent(event);
                }
                if (count == 20) {
                    var subframe = document.getElementById("subframe");
                    subframe.parentNode.removeChild(subframe);
                    document.getElementById("result").innerHTML = "Test passed.";
                    if (layoutTestController)
                        layoutTestController.notifyDone();
                }
            }
        </script>
    </head>
    <body onload="init()">
        <p>This tests whether clicking on a link to an anchor stops meta refresh reloads; it should not!</p>
        <p>We'll let the subframe load 10 times, then click the link, then let it refresh 10 more.</p>
        <p>Times subframe has loaded: <span id="count">0</span>.</p>
        <p id="result">TEST DID NOT YET COMPLETE.</p>
        <iframe id="subframe" src="resources/meta-refresh-subframe.html"></iframe>
    </body>
</html>
