<html>
<head>
<script>
if (window.layoutTestController) {
  layoutTestController.dumpAsText();
  layoutTestController.setCanOpenWindows();
  layoutTestController.setPopupBlockingEnabled(true);
  layoutTestController.setCloseRemainingWindowsWhenComplete(true);
  layoutTestController.waitUntilDone();
}

function test() {
    // Test for select that's not inside a form element
    var ctrl = document.getElementById('control');
    ctrl.focus();

    if (window.layoutTestController) {
        // change the option selection
        eventSender.keyDown("e", null);
        eventSender.keyDown("\r", null);
    }
}

function onpopup() {
  // We rely on sequential ordering of POST processing.
  var form = document.getElementById('form');
  form.submit();
  var form2 = document.getElementById('form2');
  form2.submit();
}
</script>
</head>
<body onload="test()">
<select onchange="onpopup()" id="control"><option value="0">abcd</option><option value="0">efgh</option></select>
If the pop-up was not blocked then there will be an PASS message. Otherwise, the test fails.
<form id="form" action="data:text/html,<script>alert('PASSED')</script>" target="_blank">
<input type="submit" value="Submit to new window"/>
</form>
<form id="form2" action="data:text/html,<b>hello!</b><script>window.layoutTestController && layoutTestController.notifyDone()</script>" target="panel">
<input type="submit" value="Submit local page Javascript"/>
</form>
<iframe id="panel"></iframe>
</body>
</html>
