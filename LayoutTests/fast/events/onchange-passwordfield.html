<p>This test verifies that the ENTER key fires the change and then the blur event.</p>
<hr>
<input id="input" type="password" onchange="changeHandler()" onblur="blurHandler()"></input>
<pre id="console"></pre>

<script>
function log(s)
{
    document.getElementById('console').appendChild(document.createTextNode(s + "\n"));
}

function changeHandler()
{
    lastEvent = "change";
    log ('PASS: change event fired.\n');
}

function blurHandler()
{
    lastEvent = "blur";
    log ('PASS: blur event fired.\n');
}

if (window.layoutTestController)
    layoutTestController.dumpAsText();

// change the field
document.getElementById('input').focus();
document.execCommand("InsertText", false, "foo bar baz");

// hit enter
var enterEvent = document.createEvent("KeyboardEvents");
enterEvent.initKeyboardEvent("keypress", true, false, window, "Enter", 0, false, false, false, false, false); // This is not at all like pulling teeth
input.dispatchEvent(enterEvent);

// test that blur happened last
if (lastEvent == "blur")
    log('PASS: blur event fired last.\n');
</script>
