<html>
<head>
    <script>
    function log(s)
    {
        document.getElementById('console').appendChild(document.createTextNode(s + "\n"));
    }

    function changeHandler()
    {
        log ('PASS: change event fired.\n');
    }

    function blurHandler()
    {
        log ('blur event fired.\n');
    }

    function test()
    {
        var menu = document.getElementById('menu');
        menu.focus();

        if (window.layoutTestController) {
            layoutTestController.dumpAsText();

            // change the option selection
            eventSender.keyDown('e');
        }

        // hit enter
        var enterEvent = document.createEvent("KeyboardEvents");
        enterEvent.initKeyboardEvent("keypress", true, false, window, "Enter", 0, false, false, false, false, false);
        menu.dispatchEvent(enterEvent);
    }
    </script>
</head>
<body onload="test()">
    <p>This test verifies that the ENTER key fires the change event for popups.</p>
    <hr>
    <form>
        <select id="menu" onchange="changeHandler()" onblur="blurHandler()"><option>abcd</option><option>efgh</option></select>
    </form>
    <pre id="console"></pre>
</body>
</html>
