<!DOCTYPE html>
<html>
<span id="e">FAIL</span>
<script>
if (window.layoutTestController)
    layoutTestController.dumpAsText();

var e = document.getElementById("e");
var sameFrame;
window.webkitRequestAnimationFrame(function() {
    sameFrame = true;
}, e);
window.webkitRequestAnimationFrame(function() {
    window.webkitRequestAnimationFrame(function() {
        e.innerHTML = sameFrame ? "FAIL" : "PASS";
    }, e);
}, e);
window.webkitRequestAnimationFrame(function() {
    sameFrame = false;
}, e);

// This should fire the three already registered callbacks, but not the one dynamically registered.
if (window.layoutTestController)
    layoutTestController.display();
// This should fire the dynamically registered callback.
if (window.layoutTestController)
    layoutTestController.display();
</script>
