<html manifest="resources/fail-on-update.php">
<script>
if (window.layoutTestController) {
    layoutTestController.dumpAsText();
    layoutTestController.waitUntilDone();
}

function test()
{
    applicationCache.update();
    window.location = 'data:text/html,<p>SUCCESS: No crash.</p>' + 
        '<script>' +
            'if (window.layoutTestController) layoutTestController.notifyDone();' +
        '</scri' + 'pt>';
}

applicationCache.addEventListener('noupdate', function() { setTimeout(test, 0) }, false);
applicationCache.addEventListener('cached', function() { setTimeout(test, 0) }, false);

</script>
<p>Test for a particular incorrect assertion failure.</p>

</html>
