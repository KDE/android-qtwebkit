<html>
<head>
<script>

function log(a)
{
    parent.document.getElementById("logger").innerHTML += a + "<br>";
}

function handleStorageEvent(e)
{
    log("Subframe received storage event:");
    log("Key           - " + e.key);
    log("New Value     - " + e.newValue);
    log("Old Value     - " + e.oldValue);
    log("");
    
    if (e.key != "Subframe") {
        log("Subframe about to change localStorage...");
        localStorage.setItem("Subframe", "SET");
    }
}

</script>
</head>
<body onload="document.body.addEventListener('storage', handleStorageEvent, false);">
This is the subframe which exists to make sure that both frames of a same security origin receive the event for that origin's localStorage object mutating
</body>
</html>
